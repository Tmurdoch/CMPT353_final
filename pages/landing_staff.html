<!DOCTYPE html>

<head>
<h1>Customers</h1>
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="css/landing_staff.css">
<!--===============================================================================================-->
</head>
<script>
    function update_html() {
        /* idea: xml request for posts file
            - settimeout to check for new posts in posts file (from index.html)
            - if post made in THIS script, just call this function  */
        
        var xhttp = new XMLHttpRequest();
        xhttp.open("GET", "/show_all_customers", true);
        xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        xhttp.onreadystatechange = () => {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                const res = JSON.parse(xhttp.responseText);
                console.log("res: ", res);
                res.forEach((item, index) => {
                    
                    console.log(item);
                    var list = document.getElementById('customers');
                    
                    var entry = document.createElement('li');
                    entry.appendChild(document.createTextNode(item.name.toString().concat(item.date.toString())));
                    list.appendChild(entry);
                });

            }
        }
        xhttp.send();
        return;
        
    }
    update_html();
</script>

<body>
    <form action="/add_customer" method="post">
        <label for= "name">Customer name</label>
        <br>
        <input type="text" name="name" id="name" required maxlength="45" >
        <br>
        <label for="age">Age</label>
        <br>
        <input type="text" name="age" >
        <br>
        <label for="date">Date</label>
        <br>
        <input type="text" name="date" >
        <br>
        <label for="summary">Summary of consultation</label><br>
        <textarea name="summary" rows="10" cols="30">add text</textarea> 
        <br>
        <label for="other_info">Other info</label><br>
        <textarea name="other_info" rows="10" cols="30">(optional)</textarea> 
        <br>
        <input type="submit" value="Submit">
    </form>


    <div id="answer">
    <ul id="customers">
    </ul>
    </div>
</body>